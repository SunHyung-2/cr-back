<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.amaranth10.cr.cra.cra2000.mapper.CRA2000Mapper">

<!--    상용구 목록 조회-->
    <select id="blpeList" resultType="com.amaranth10.cr.cra.cra2000.model.Tree">
        SELECT cmcd_char_valu1 AS parent, cmcd_cd AS code, cmcd_nm AS name, 'N' AS blpe_yn
          FROM czcomcodmt
         WHERE hspt_cd = #{hspt_cd}
           AND cmcd_clsf_cd = 'CRZ001'
         UNION ALL
        SELECT blpe_clsf AS parent, blpe_sqno AS code, blpe_nm AS name, 'Y' AS blpe_yn
          FROM crblpmngmt
         WHERE hspt_cd = #{hspt_cd}
           AND inps_usid = #{inps_usid}
    </select>

<!--    상용구 목록 검색-->
    <select id="searchBlpe" resultType="com.amaranth10.cr.cra.cra2000.model.Tree">
        SELECT blpe_sqno AS code, blpe_nm AS name
          FROM crblpmngmt
         WHERE hspt_cd = #{hspt_cd}
           AND inps_usid = #{inps_usid}
           AND blpe_nm LIKE CONCAT ('%', #{keyword}, '%')
    </select>

<!--    상용구 삭제-->
    <delete id="deleteBlpe">
        DELETE FROM crblpmngmt
         WHERE hspt_cd = #{hspt_cd}
           AND blpe_sqno = #{blpe_sqno}
    </delete>

<!--    상용구 분류 DropDownList 조회-->
    <select id="comBlpeList" resultType="java.util.HashMap">
        SELECT cmcd_cd AS value, cmcd_nm AS labelText
          FROM czcomcodmt
         WHERE hspt_cd = #{hspt_cd}
           AND cmcd_clsf_cd = 'CRZ001'
           AND cmcd_cd != '*'
         ORDER BY cmcd_sort_seq
    </select>

<!--    상용구 상세 조회-->
    <select id="blpeDetail" resultType="com.amaranth10.cr.cra.cra2000.model.Tree">
        SELECT blpe_clsf AS parent, blpe_sqno AS code, blpe_nm AS name, blpe_cnts AS cnts
          FROM crblpmngmt
         WHERE hspt_cd = #{hspt_cd}
           AND inps_usid = #{inps_usid}
           AND blpe_sqno = #{blpe_sqno}
    </select>

<!--    상용구 추가-->
    <insert id="insertBlpe">
        INSERT INTO crblpmngmt (hspt_cd, frst_rgst_usid, frst_rgdt, last_updt_usid, last_uddt, inps_usid, blpe_clsf, blpe_nm, blpe_cnts)
        VALUES (#{hspt_cd}, #{frst_rgst_usid}, #{frst_rgdt}, #{last_updt_usid}, #{last_uddt}, #{inps_usid}, #{blpe_clsf}, #{blpe_nm}, #{blpe_cnts})
    </insert>

<!--    상용구 수정-->
    <update id="updateBlpe">
        UPDATE crblpmngmt
           SET last_updt_usid = #{last_updt_usid},
               last_uddt = #{last_uddt},
               blpe_clsf = #{blpe_clsf},
               blpe_nm = #{blpe_nm},
               blpe_cnts = #{blpe_cnts}
         WHERE hspt_cd = #{hspt_cd}
           AND inps_usid = #{inps_usid}
           AND blpe_sqno = #{blpe_sqno}
    </update>

</mapper>